---
title: "T20 Match Analysis"
author: "T Baynes"
date: "December 22, 2015"
output: html_document
---

This is my first experiment with uing R Markdown.

First lets run the code that processes all the raw files from Cricsheet:

```{r, message = FALSE, error = FALSE, warning = FALSE}
source("process_cricsheet.R")
```

Then lets do some calculations to work out the win, losses, no results and ties for each team:

```{r}
team_summary <- matches_df %>%
    group_by(teams) %>%
    summarise(games = length(teams),
              wins = sum(outcome.winner==teams, na.rm = TRUE),
              losses = sum(outcome.winner!= teams, na.rm = TRUE) - sum(is.na(outcome.winner), na.rm = TRUE),
              no_result = sum(result == "no result", na.rm = TRUE),
              tie = sum(outcome.result == "tie", na.rm= TRUE))

team_summary
```

And maybe a plot:

```{r}

ggplot(team_summary, aes(x = teams, y = wins)) + geom_bar(stat = "identity")
```

But that plot looks pretty hideous, let's try and sort it out.  First lets order the bars and fix the x axis labels.

```{r}
team_summary$teams <- factor(team_summary$teams, levels = team_summary$teams[order(team_summary$wins, decreasing = TRUE)])
ggplot(team_summary, aes( x = teams, y = wins)) + geom_bar(stat = "identity") +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle=90, vjust=0.3, hjust = 1, size=10))
```

That's a lot better, but I don't like the standard colours, so let's go for `theme_bw()` and change the bar colour to blue.

```{r}
ggplot(team_summary, aes( x = teams, y = wins)) + geom_bar(stat = "identity", fill = "Blue") +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x  = element_text(angle=90, vjust=0.3, hjust = 1, size=10))
```

Much, better, but it's still hard to read the axis labels, let's go for horizontal bars.

```{r}
ggplot(team_summary, aes( x = teams, y = wins)) + geom_bar(stat = "identity", fill = "Blue") +
  theme_bw() +
  theme(axis.title.x = element_blank()) +
  coord_flip()
```

Hmm, now the bars are the wrong way around, so we'll have to reorder the levels of the teams again

```{r}
team_summary$teams <- factor(team_summary$teams, levels = team_summary$teams[order(team_summary$wins, decreasing = FALSE)])
ggplot(team_summary, aes( x = teams, y = wins)) + geom_bar(stat = "identity", fill = "Blue") +
  theme_bw() +
  theme(axis.title.x = element_blank()) +
  coord_flip()
  

